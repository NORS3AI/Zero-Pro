/* phase12.css — Phase 12: Character Database, Wiki Links, Plot Templates, Project Templates */

/* ─── Shared overlay shell ───────────────────────────────────────────────────── */

.p12-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1200;
}
.p12-overlay.hidden { display: none; }

/* ─── Character Database ─────────────────────────────────────────────────────── */

.char-modal {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg, 10px);
  width: min(900px, 94vw);
  height: min(82vh, 680px);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 12px 48px rgba(0,0,0,0.4);
}

.char-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 20px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
  gap: 12px;
}
.char-header h3 { margin: 0; font-size: 1.05rem; flex: 1; }
.char-header-actions { display: flex; gap: 8px; align-items: center; }

.char-close {
  background: none; border: none; font-size: 1.4rem;
  cursor: pointer; color: var(--fg-muted); padding: 2px 6px;
}
.char-close:hover { color: var(--fg); }

.char-body {
  flex: 1;
  display: flex;
  overflow: hidden;
}

/* List pane */
.char-list-col {
  width: 240px;
  flex-shrink: 0;
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.char-search-wrap {
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}
.char-search {
  width: 100%;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 5px 9px;
  font-size: 0.82rem;
  color: var(--fg);
}
.char-search:focus { outline: 2px solid var(--accent); }

.char-list {
  flex: 1;
  overflow-y: auto;
  padding: 6px 8px;
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.char-list-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 10px;
  border-radius: 6px;
  cursor: pointer;
  border: 1px solid transparent;
}
.char-list-item:hover { background: var(--bg); }
.char-list-item.active { background: var(--bg); border-color: var(--accent); }
.char-avatar {
  width: 28px; height: 28px;
  border-radius: 50%;
  background: var(--accent);
  display: flex; align-items: center; justify-content: center;
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--bg);
  flex-shrink: 0;
}
.char-list-name { font-size: 0.85rem; font-weight: 500; flex: 1; }
.char-list-role { font-size: 0.7rem; color: var(--fg-muted); }
.char-empty { font-size: 0.82rem; color: var(--fg-muted); text-align: center; padding: 20px 12px; }

/* Edit pane */
.char-edit-col {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.char-no-selection {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--fg-muted);
  font-size: 0.9rem;
}

.char-field-row { display: flex; gap: 12px; }
.char-field { display: flex; flex-direction: column; gap: 5px; flex: 1; }
.char-label { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--fg-muted); font-weight: 600; }
.char-input, .char-select, .char-textarea {
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 7px 10px;
  font-size: 0.85rem;
  color: var(--fg);
  font-family: inherit;
}
.char-input:focus, .char-select:focus, .char-textarea:focus { outline: 2px solid var(--accent); }
.char-textarea { min-height: 80px; resize: vertical; }

.char-role-badge {
  display: inline-block;
  font-size: 0.68rem;
  padding: 2px 8px;
  border-radius: 99px;
  font-weight: 600;
  text-transform: capitalize;
}
.char-role-protagonist { background: rgba(var(--accent-rgb, 100,140,255), 0.2); color: var(--accent); }
.char-role-antagonist  { background: rgba(220,80,80,0.18); color: #e05050; }
.char-role-supporting  { background: rgba(80,180,120,0.18); color: #3ab478; }
.char-role-minor       { background: var(--bg); color: var(--fg-muted); }

.char-delete-btn {
  align-self: flex-start;
  font-size: 0.78rem;
  color: var(--fg-muted);
  background: none;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 4px 10px;
  cursor: pointer;
  margin-top: 8px;
}
.char-delete-btn:hover { color: #e05; border-color: #e05; }

/* ─── Wiki-link autocomplete dropdown ────────────────────────────────────────── */

.wiki-autocomplete {
  position: fixed;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: 0 8px 24px rgba(0,0,0,0.3);
  z-index: 2000;
  min-width: 200px;
  max-width: 300px;
  max-height: 200px;
  overflow-y: auto;
  display: none;
}
.wiki-autocomplete.open { display: block; }
.wiki-ac-item {
  padding: 7px 12px;
  font-size: 0.85rem;
  cursor: pointer;
  color: var(--fg);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.wiki-ac-item:hover, .wiki-ac-item.selected { background: var(--bg); color: var(--accent); }
.wiki-ac-empty { padding: 10px 12px; font-size: 0.82rem; color: var(--fg-muted); }

/* Wiki links rendered in the editor */
a.wiki-link {
  color: var(--accent);
  text-decoration: underline dotted;
  cursor: pointer;
}
a.wiki-link:hover { text-decoration: underline; }

/* ─── Plot Structure Templates ───────────────────────────────────────────────── */

.pt-modal {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg, 10px);
  width: min(760px, 92vw);
  max-height: 86vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 12px 48px rgba(0,0,0,0.4);
}
.pt-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 20px; border-bottom: 1px solid var(--border); flex-shrink: 0;
}
.pt-header h3 { margin: 0; font-size: 1.05rem; }
.pt-close { background: none; border: none; font-size: 1.4rem; cursor: pointer; color: var(--fg-muted); padding: 2px 6px; }
.pt-close:hover { color: var(--fg); }

.pt-body { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 20px; }

.pt-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px; }
.pt-card {
  background: var(--bg);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  cursor: pointer;
  transition: border-color 0.15s, transform 0.1s;
}
.pt-card:hover { border-color: var(--accent); transform: translateY(-2px); }
.pt-card.selected { border-color: var(--accent); background: rgba(var(--accent-rgb, 100,140,255), 0.08); }
.pt-card-icon { font-size: 1.6rem; margin-bottom: 8px; }
.pt-card-name { font-size: 0.9rem; font-weight: 600; margin-bottom: 4px; }
.pt-card-desc { font-size: 0.76rem; color: var(--fg-muted); line-height: 1.5; }

.pt-stages { display: flex; flex-direction: column; gap: 4px; }
.pt-stage {
  display: flex; align-items: flex-start; gap: 10px;
  padding: 8px 10px; background: var(--bg); border-radius: 6px;
}
.pt-stage-num {
  font-size: 0.7rem; font-weight: 700; color: var(--accent);
  background: rgba(var(--accent-rgb, 100,140,255), 0.15);
  border-radius: 4px; padding: 2px 6px; flex-shrink: 0; margin-top: 1px;
}
.pt-stage-name { font-size: 0.84rem; font-weight: 600; }
.pt-stage-desc { font-size: 0.76rem; color: var(--fg-muted); margin-top: 2px; }

.pt-footer {
  display: flex; gap: 10px; justify-content: flex-end;
  padding: 12px 20px; border-top: 1px solid var(--border); flex-shrink: 0;
}

/* ─── Project Templates Wizard ───────────────────────────────────────────────── */

.tmpl-modal {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg, 10px);
  width: min(720px, 92vw);
  max-height: 84vh;
  display: flex; flex-direction: column;
  overflow: hidden;
  box-shadow: 0 12px 48px rgba(0,0,0,0.4);
}
.tmpl-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 20px; border-bottom: 1px solid var(--border); flex-shrink: 0;
}
.tmpl-header h3 { margin: 0; font-size: 1.05rem; }
.tmpl-close { background: none; border: none; font-size: 1.4rem; cursor: pointer; color: var(--fg-muted); padding: 2px 6px; }
.tmpl-close:hover { color: var(--fg); }
.tmpl-body { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 16px; }
.tmpl-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 12px; }
.tmpl-card {
  background: var(--bg); border: 2px solid var(--border); border-radius: var(--radius);
  padding: 16px; cursor: pointer; transition: border-color 0.15s, transform 0.1s; text-align: center;
}
.tmpl-card:hover { border-color: var(--accent); transform: translateY(-2px); }
.tmpl-card.selected { border-color: var(--accent); background: rgba(var(--accent-rgb, 100,140,255), 0.08); }
.tmpl-card-icon { font-size: 2rem; margin-bottom: 8px; }
.tmpl-card-name { font-size: 0.88rem; font-weight: 600; margin-bottom: 4px; }
.tmpl-card-desc { font-size: 0.73rem; color: var(--fg-muted); line-height: 1.4; }

.tmpl-config { display: flex; flex-direction: column; gap: 10px; }
.tmpl-config-label { font-size: 0.8rem; color: var(--fg-muted); font-weight: 600; }
.tmpl-config-input {
  background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 8px 12px; font-size: 0.9rem; color: var(--fg); width: 100%;
}
.tmpl-config-input:focus { outline: 2px solid var(--accent); }

.tmpl-preview { background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); padding: 12px; }
.tmpl-preview-title { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--fg-muted); margin-bottom: 8px; font-weight: 600; }
.tmpl-tree { font-size: 0.8rem; color: var(--fg-muted); line-height: 1.9; font-family: var(--font-mono, monospace); }
.tmpl-tree .folder { color: var(--fg); font-weight: 600; }

.tmpl-footer {
  display: flex; gap: 10px; justify-content: flex-end;
  padding: 12px 20px; border-top: 1px solid var(--border); flex-shrink: 0;
}
